<!DOCTYPE html>
<html>
<head>
    <title>Crescent School Admin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      body { font-family:'Segoe UI',sans-serif; background:#f7fff4; color:#234013; }
      .main { max-width:500px; margin:3em auto; background:#fff; border-radius:12px; box-shadow:0 3px 12px #a3be6330; padding:32px;}
      h2 { color:#5b8d2d;}
      input,textarea,select,button { width:100%; padding:8px; margin:6px 0 16px 0; border-radius:5px; border:1px solid #a3be63; }
      label { font-weight:600;}
      .section { margin-bottom:36px; border-bottom:1px solid #e7efe2; padding-bottom:24px;}
      .gallery-preview img {max-width:100px;}
    </style>
</head>
<body>
    <div class="main">
        <h2>Crescent School Admin</h2>
        <div class="section">
            <h3>Add Update</h3>
            <label>Title</label><input id="update-title"><br>
            <label>Text</label><textarea id="update-text"></textarea><br>
            <button onclick="addUpdate()">Add Update</button>
        </div>
        <div class="section">
            <h3>Add Calendar Event</h3>
            <label>Event Title</label><input id="event-title"><br>
            <label>Date</label><input id="event-date" type="date"><br>
            <label>Description</label><textarea id="event-desc"></textarea><br>
            <button onclick="addCal()">Add Event</button>
        </div>
        <div class="section">
            <h3>Add Gallery Photo</h3>
            <label>Pick photo</label><input type="file" id="gallery-img"><br>
            <button onclick="addGallery()">Upload Photo</button>
            <div class="gallery-preview"></div>
        </div>
    </div>
    <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.2/firebase-storage-compat.js"></script>
    <script>
        // Firebase config
        const firebaseConfig = {
          apiKey: "AIzaSyBBIG7IpuY8Hc3E0_zcEyon06an8ll6TGw",
          authDomain: "school-test-4b350.firebaseapp.com",
          projectId: "school-test-4b350",
          storageBucket: "school-test-4b350.appspot.com",
          messagingSenderId: "557567714700",
          appId: "1:557567714700:web:be0df02162246ee5d5a2a9"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const storage = firebase.storage();

        function addUpdate() {
            const t = document.getElementById('update-title').value;
            const txt = document.getElementById('update-text').value;
            if(!t||!txt) { alert('Fill all fields'); return; }
            db.ref('updates').push({ title:t, text:txt, date:new Date().toLocaleString() });
            alert('Update added!');
        }
        function addCal() {
            const t = document.getElementById('event-title').value;
            const d = document.getElementById('event-date').value;
            const desc = document.getElementById('event-desc').value;
            if(!t||!d) { alert('Fill all fields'); return; }
            db.ref('calendar').push({ title:t, date:d, description:desc });
            alert('Event Added!');
        }
        function addGallery() {
            const f = document.getElementById('gallery-img').files[0];
            if(!f) return alert('Pick an image');
            const ref = storage.ref('gallery/' + Date.now() + '_' + f.name);
            ref.put(f).then(snap => ref.getDownloadURL().then(url=>{
                db.ref('gallery').push({url:url});
                document.querySelector('.gallery-preview').innerHTML += `<img src="${url}" />`;
                alert('Image uploaded!');
            }));
        }
    </script>
</body>
</html>
